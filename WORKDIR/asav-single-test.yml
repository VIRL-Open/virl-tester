#
# ping test
# from lxc-1   (10.0.0.6)
# via  asav-1  (10.0.0.5 / 10.0.0.9)
# to   lxc-2   (10.0.0.10)
# 
# ping from lxc-2 to lxc-1 must fail
# as that goes from outside to inside
# and will be blocked (0 --> 100)
#
# ralph
#

config:
  # the VIRL host
  host: {{ env['VIRL_HOST'] or "localhost" }}
  port: {{ env['VIRL_PORT'] or 19399 }}

  # username and password
  user: {{ env['VIRL_USER'] or "guest" }}
  password: {{ env['VIRL_PASS'] or "guest" }}
  # loglevel (0-4, 4=Debug)
  loglevel: 2
  # default wait time (spinup / actions)
  wait: 300
  #parallel: 1


sims:
- topo: Topos/asav-single-test.virl
  nodes:
  - lxc-1:
    - type: converge
      transport: ssh
      sleep: 5
      in:
      - ping -W1 -c1 10.0.0.10
      out:
      - \ 0% packet loss
    - type: command
      transport: ssh
      in:
      - ping -c5 10.0.0.10
      out:
      - \ 0% packet loss
  - lxc-2:
    - type: command
      transport: ssh
      wait: 60
      in:
      - ping -ODc5 -W3 10.0.0.6
      out:
      - 100% packet loss
